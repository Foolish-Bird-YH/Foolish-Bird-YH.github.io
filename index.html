<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>激战当日好友码生成</title>
</head>

<body>
    <p>好友代码: <input type="text" id="friend_code" /></p>
    <p><input type="button" value="生成当日好友码" id="gen_qr_code" onclick="func()" /></p>
    <script>
        var getQR = function () {
            let n2t = {
                0: 'B',
                1: 'C',
                2: 'D',
                3: 'E',
                4: 'F',
                5: 'G',
                6: 'H',
                7: 'J',
                8: 'K',
                9: 'M',
                a: 'N',
                b: 'P',
                c: 'Q',
                d: 'R',
                e: 'S',
                f: 'T',
            };
            let timestamp = Date.now().toString(16).split("");
            let timeText = "";
            timestamp.forEach(function (e) {
                timeText += n2t[e]
            });
            return timeText;
        }
        function func() {
            let r = getQR()
            let origin_code = document.getElementById("friend_code");
            let code = '4,${origin_code}${r}';
            code = code.replace('${origin_code}', origin_code.value);
            code = code.replace('${r}', r);
            let url = 'https://tool.oschina.net/action/qrcode/generate?data=${code}&output=image%2Fpng&error=L&type=0&margin=16&size=4&1685244645838';
            url = url.replace('${code}', code);
            window.open(url, '_');
        }
    </script>
</body>

</html>